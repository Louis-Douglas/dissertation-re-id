import numpy as np
from scipy import stats

ALPHA = 0.05

def cohens_d_paired(x, y):
    """Cohen's d for paired samples"""
    diff = np.array(y) - np.array(x)
    return np.mean(diff) / np.std(diff, ddof=1)

def hypothesis_1(hybrid_metrics: dict, baseline_metrics: dict):
    """
    Hypothesis 1:
    H1: The proposed hybrid approach will demonstrate
    significantly higher person Re-ID performance
    compared to a conventional CNN-based system.

    H0: The proposed hybrid approach does not
    demonstrate a statistically significant improvement in
    person Re-ID performance compared to a
    conventional CNN-based system.

    Parameters:
        hybrid_metrics (dict): Contains arrays for 'rank1', 'rank5', and 'ap' for
        the hybrid approach.
        baseline_metrics (dict): Contains arrays for the same keys for the baseline approach.
    """
    print("Hypothesis 1: Hybrid vs. Baseline")
    for metric in ['rank1', 'rank5', 'ap']:
        hybrid_arr = hybrid_metrics[metric]
        baseline_arr = baseline_metrics[metric]

        # Compute mean and standard deviation
        hybrid_mean = np.mean(hybrid_arr)
        hybrid_std = np.std(hybrid_arr)
        baseline_mean = np.mean(baseline_arr)
        baseline_std = np.std(baseline_arr)

        cohens_d = cohens_d_paired(baseline_arr, hybrid_arr)

        print(f"{metric.upper()} - Hybrid cropped: "
              f"mean = {hybrid_mean:.3f}, "
              f"std = {hybrid_std:.3f}")
        print(f"{metric.upper()} - Resnet50 cropped: "
              f"mean = {baseline_mean:.3f}, "
              f"std = {baseline_std:.3f}")

        try:
            result = stats.wilcoxon(hybrid_arr, baseline_arr)
            stat = result.statistic
            p_val = result.pvalue
            print(f"{metric.upper()}: Wilcoxon statistic = {stat:.3f}, "
                  f"p-value = {p_val:.4f}, "
                  f"d = {cohens_d:.4f}")
            if p_val < ALPHA:
                print(f"  -> Reject H0 for {metric.upper()}: "
                      f"significant difference detected.\n")
            else:
                print(f"  -> Fail to reject H0 for {metric.upper()}: "
                      f"no significant difference.\n")
        except Exception as e:
            print(f"Error testing {metric.upper()}: {e}")


def hypothesis_2(hybrid_uncropped_metrics: dict,
                 baseline_uncropped_metrics: dict,
                 hybrid_cropped_metrics: dict):
    """
    Hypothesis 2:
    H1: The hybrid approach will outperform a
    traditional CNN-based approach in terms of person
    Re-ID accuracy when processing un-cropped images
    due to its ability to isolate meaningful object
    segments.

    H0: here is no statistically significant difference in
    person Re-ID performance between the hybrid
    method and the CNN-based method when using
    un-cropped images.

    Parameters:
        hybrid_uncropped_metrics, hybrid_cropped_metrics, cnn_cropped_metrics (dict):
            Each dictionary contains per-query arrays for 'rank1', 'rank5', and 'ap'.
    """
    print("Hypothesis 2: Hybrid vs. Baseline (Un-cropped)")
    for metric in ['rank1', 'rank5', 'ap']:
        hybrid_uncropped_arr = hybrid_uncropped_metrics[metric]
        baseline_uncropped_arr = baseline_uncropped_metrics[metric]

        # Compute mean and standard deviation
        hybrid_uncropped_mean = np.mean(hybrid_uncropped_arr)
        hybrid_uncropped_std = np.std(hybrid_uncropped_arr)
        baseline_uncropped_mean = np.mean(baseline_uncropped_arr)
        baseline_uncropped_std = np.std(baseline_uncropped_arr)

        cohens_d = cohens_d_paired(baseline_uncropped_arr, hybrid_uncropped_arr)

        print(f"{metric.upper()} - Hybrid un-cropped: "
              f"mean = {hybrid_uncropped_mean:.3f}, "
              f"std = {hybrid_uncropped_std:.3f}")
        print(f"{metric.upper()} - Resnet50 un-cropped: "
              f"mean = {baseline_uncropped_mean:.3f}, "
              f"std = {baseline_uncropped_std:.3f}")

        try:
            result = stats.wilcoxon(hybrid_uncropped_arr, baseline_uncropped_arr)
            stat = result.statistic
            p_val = result.pvalue
            print(f"{metric.upper()} (Cropped): "
                  f"Wilcoxon statistic = {stat:.3f}, "
                  f"p-value = {p_val:.4f}, "
                  f"d = {cohens_d:.4f}")
            if p_val < ALPHA:
                print(f"  -> Reject H0 for {metric.upper()} (Cropped): "
                      f"significant difference detected.\n")
            else:
                print(f"  -> Fail to reject H0 for {metric.upper()} (Cropped): "
                      f"no significant difference.\n")
        except Exception as e:
            print(f"Error testing {metric.upper()} (Cropped): {e}")

    print("Hypothesis 2 Extra Hybrid Analysis: Hybrid (Cropped) vs. Hybrid (Uncropped)")
    for metric in ['rank1', 'rank5', 'ap']:
        try:
            hybrid_uncropped_arr = hybrid_uncropped_metrics[metric]
            hybrid_cropped_arr = hybrid_cropped_metrics[metric]

            # Compute mean and standard deviation
            hybrid_uncropped_mean = np.mean(hybrid_uncropped_arr)
            hybrid_uncropped_std = np.std(hybrid_uncropped_arr)
            hybrid_cropped_mean = np.mean(hybrid_cropped_arr)
            hybrid_cropped_std = np.std(hybrid_cropped_arr)

            cohens_d = cohens_d_paired(hybrid_uncropped_arr, hybrid_cropped_arr)

            print(f"{metric.upper()} - Hybrid un-cropped: "
                  f"mean = {hybrid_uncropped_mean:.3f}, "
                  f"std = {hybrid_uncropped_std:.3f}")
            print(f"{metric.upper()} - Hybrid cropped: "
                  f"mean = {hybrid_cropped_mean:.3f}, "
                  f"std = {hybrid_cropped_std:.3f}")

            result = stats.wilcoxon(hybrid_uncropped_arr, hybrid_cropped_arr)
            stat = result.statistic
            p_val = result.pvalue

            print(f"{metric.upper()} (Uncropped): "
                  f"Wilcoxon statistic = {stat:.3f}, "
                  f"p-value = {p_val:.4f}, "
                  f"d = {cohens_d:.4f}")
            if p_val < ALPHA:
                print(f"  -> Reject H0 for {metric.upper()} (Uncropped): "
                      f"significant difference detected.\n")
            else:
                print(f"  -> Fail to reject H0 for {metric.upper()} (Uncropped): "
                      f"no significant difference.\n")
        except Exception as e:
            print(f"Error testing {metric.upper()} (Uncropped): {e}")



def hypothesis_3(clahe_metrics_uncropped: dict,
                 non_clahe_metrics_uncropped: dict,
                 clahe_metrics_cropped: dict,
                 non_clahe_metrics_cropped: dict):
    """
    Hypothesis 3:
    H1: Incorporating CLAHE into the Re-ID pipeline
    will significantly improve person matching accuracy
    under varying illumination.

    H0: CLAHE does not produce a statistically
    significant improvement in person Re-ID
    performance under varying illumination conditions.

    Parameters:
        clahe_metrics (dict): Per-query arrays for 'rank1', 'rank5', and 'ap' with CLAHE.
        non_clahe_metrics (dict): Per-query arrays for the same metrics without CLAHE.
    """
    print("Hypothesis 3 cropped: CLAHE vs. No CLAHE on cropped images")
    for metric in ['rank1', 'rank5', 'ap']:
        try:
            clahe_cropped_arr = clahe_metrics_cropped[metric]
            non_clahe_cropped_arr = non_clahe_metrics_cropped[metric]

            # Compute mean and standard deviation
            clahe_cropped_mean = np.mean(clahe_cropped_arr)
            clahe_cropped_std = np.std(clahe_cropped_arr)
            non_clahe_cropped_mean = np.mean(non_clahe_cropped_arr)
            non_clahe_cropped_std = np.std(non_clahe_cropped_arr)

            cohens_d = cohens_d_paired(non_clahe_cropped_arr, clahe_cropped_arr)

            print(f"{metric.upper()} - CLAHE cropped: "
                  f"mean = {clahe_cropped_mean:.3f}, "
                  f"std = {clahe_cropped_std:.3f}")
            print(f"{metric.upper()} - Non CLAHE cropped: "
                  f"mean = {non_clahe_cropped_mean:.3f}, "
                  f"std = {non_clahe_cropped_std:.3f}")

            result = stats.wilcoxon(clahe_cropped_arr, non_clahe_cropped_arr)
            stat = result.statistic
            p_val = result.pvalue
            print(f"{metric.upper()}: Wilcoxon statistic = {stat:.3f}, "
                  f"p-value = {p_val:.4f}, "
                  f"d = {cohens_d:.4f}")
            if p_val < ALPHA:
                print(f"  -> Reject H0 for {metric.upper()}: "
                      f"significant difference detected\n")
            else:
                print(f"  -> Fail to reject H0 for {metric.upper()}: "
                      f"no significant difference.\n")
        except Exception as e:
            print(f"Error testing {metric.upper()}: {e}")

    print("Hypothesis 3 un-cropped: CLAHE vs. No CLAHE on un-cropped images")
    for metric in ['rank1', 'rank5', 'ap']:
        try:
            clahe_uncropped_arr = clahe_metrics_uncropped[metric]
            non_clahe_uncropped_arr = non_clahe_metrics_uncropped[metric]

            # Compute mean and standard deviation
            clahe_uncropped_mean = np.mean(clahe_uncropped_arr)
            clahe_uncropped_std = np.std(clahe_uncropped_arr)
            non_clahe_uncropped_mean = np.mean(non_clahe_uncropped_arr)
            non_clahe_uncropped_std = np.std(non_clahe_uncropped_arr)

            cohens_d = cohens_d_paired(non_clahe_uncropped_arr, clahe_uncropped_arr)

            print(f"{metric.upper()} - CLAHE un-cropped: "
                  f"mean = {clahe_uncropped_mean:.3f}, "
                  f"std = {clahe_uncropped_std:.3f}")
            print(f"{metric.upper()} - Non CLAHE un-cropped: "
                  f"mean = {non_clahe_uncropped_mean:.3f}, "
                  f"std = {non_clahe_uncropped_std:.3f}")

            result = stats.wilcoxon(clahe_uncropped_arr, non_clahe_uncropped_arr)
            stat = result.statistic
            p_val = result.pvalue
            print(f"{metric.upper()}: Wilcoxon statistic = {stat:.3f}, "
                  f"p-value = {p_val:.4f}, "
                  f"d = {cohens_d:.4f}")
            if p_val < ALPHA:
                print(f"  -> Reject H0 for {metric.upper()}: "
                      f"significant difference detected.\n")
            else:
                print(f"  -> Fail to reject H0 for {metric.upper()}: "
                      f"no significant difference.\n")
        except Exception as e:
            print(f"Error testing {metric.upper()}: {e}")


if __name__ == "__main__":
    # These are computed using evaluate_rank_map_per_query.
    hybrid_cropped_clahe = {
        'rank1': np.array([1, 0, 0, 0, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1]),
        'rank5': np.array([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]),
        'ap': np.array([0.7592226292226291, 0.2878201905452997, 0.4668321965475666, 0.30835209345614506, 0.8951365663322185, 1.0, 0.7033023088155262, 0.3834003505026313, 0.8937010212010212, 0.1664045342281405, 0.7805072145408279, 0.34727921695518016, 0.11239555883252614, 0.7225054653626081, 0.8083255285344838, 0.6968919715319659, 0.38392543787896527, 0.8994630369630369, 0.18535935301830178, 0.8069823242755574, 0.39356060606060606, 0.7254790460435623, 0.1805563979193127, 0.8165946266632763, 0.9530525030525032, 0.4420515972765609, 0.47454279816370826, 0.9740021008403362, 1.0, 0.8299080298786181, 0.7824434720949351, 0.0654510654494608, 0.7872736985236987, 0.7741973518289309, 0.27721300738505494, 0.4817931889161044, 0.5965747215747216, 0.7586432504543961, 0.27002275318729646, 0.6084136994265256, 0.36048283259368163, 0.8793650793650793, 0.6750790316126452, 0.24434520316054542, 0.9888888888888889, 0.585014741512209, 0.5986610618865521, 0.4068242963380098, 0.8011650410992516, 0.911886446886447, 0.7944264407563639, 0.4174468695202204, 0.48040174172126543, 0.775147075147075, 0.5503840342697172, 0.9945054945054945, 0.910952380952381, 0.9407893032893033, 0.6500930981207701, 0.9310457516339868, 0.16667908715530333, 0.8754900192400191, 0.8277650085066964, 0.8168078707784591, 0.33769405782461875, 0.8039400213313256, 0.8397807439474106, 0.13163350625210604, 0.24491321186459283, 0.6766300975058163, 0.5786898332020283, 0.6340691263782868, 0.7916060047432598, 0.34753922200866055, 0.5582054574382181, 0.9698826173826174, 0.9282538611485979, 0.8664833161825644, 0.6262097137097137, 0.6147008064399369, 0.6311249106249106, 0.8031980659503596, 0.8689148922972455, 0.6110389433536175, 0.2920017482517483, 0.5183703346203347, 0.8184869759869761, 0.9733333333333333, 0.8232182742007157, 0.4762917828995933, 0.5664136811265998, 0.6243474119382628, 0.6720133777650902, 0.8342664131764072, 0.6929932926836954, 0.4277193012908567, 0.8807171717171717, 0.7969781420535439, 0.90830195947843, 0.5784756606219132])
    }
    baseline_cropped = {
        'rank1': np.array([1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0]),
        'rank5': np.array([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]),
        'ap': np.array([0.9585881509794554, 0.26883186120620634, 0.116813697227006, 0.6095255865108806, 0.283792530151119, 0.5994405594405594, 0.5896608946608947, 0.8423738770537817, 0.6626814476814477, 0.7554551494257375, 0.3805454863728133, 0.44012279659537556, 0.4497485784006398, 0.726201630118409, 0.749128490557062, 0.1696371265710069, 0.49123430486889597, 0.18281891215639642, 0.48300426657537704, 0.5531023302515606, 0.0380658466651037, 0.8135899494394027, 0.23796669086967243, 0.766265240136208, 0.9705128205128206, 0.3758857295168833, 0.3715583750576517, 0.9438775510204083, 0.8933470954657396, 0.46616006673245824, 0.6426622195878778, 0.5114059815361581, 0.11468150451863805, 0.3494180984240426, 0.6150775613275613, 0.37465651887492507, 0.06477403343441815, 0.31895093771180827, 0.6338615438259215, 0.790028528733988, 0.9598765432098766, 0.29588839656081056, 0.39707957187114407, 0.7376848988259687, 0.6670715441660389, 0.5426916236368594, 0.7846941755562443, 0.44533016906443634, 0.3413098023384436, 0.30321478587786965, 0.39615516814058793, 0.21204201181675703, 0.3756984417323936, 0.7347753261442651, 0.3804420344921416, 0.7665282639553197, 0.7025856496444731, 0.39888773085478296, 0.3972184409970826, 0.10474048902768508, 0.3766252284683863, 0.7154390516890516, 0.2613502850140322, 0.16936721738897553, 0.33091718470081694, 0.7650109123017713, 0.6769951454108252, 0.2107436830912268, 0.2707407359225472, 0.43496802435023857, 0.40537262138722513, 0.407142075293698, 0.47068413767627876, 0.605202558703041, 0.292912512325511, 0.8229918229918229, 0.5910647986841954, 0.7345132624267963, 0.11287811205058203, 0.8762866762866762, 0.5631969532078803, 0.6600422646880448, 0.6334760593412551, 0.7942989066217359, 0.4455887116617922, 0.4346071276753866, 0.6971298961790686, 0.5460068728645948, 0.3472563202819724, 0.211005118025467, 0.6366150860888509, 0.1891573302734497, 0.37839338990122223, 0.658678369597217, 0.3807569378983207, 0.3508435549649688, 0.6489752491914338, 0.24258756577600682, 0.6723298797136008, 0.14893915119729725])
    }
    hypothesis_1(hybrid_cropped_clahe, baseline_cropped)

    hybrid_uncropped_clahe = {
        'rank1': np.array([1, 0, 0, 0, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1]),
        'rank5': np.array([1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]),
        'ap': np.array([0.9723622782446313, 0.2385206577267833, 0.13396901324648386, 0.2547921446114115, 0.8286554715126143, 0.9571428571428572, 0.6764903748093327, 0.353368535010693, 0.8262502158699377, 0.2122018239312386, 0.6241110362159868, 0.24174570690319505, 0.1514366574348444, 0.7154292136434994, 0.7428754709188277, 0.7382910111445005, 0.5653212562577888, 0.8240395153884891, 0.7569832264685208, 0.9910714285714286, 0.08980607979509692, 0.7755467085392561, 0.24761166412922245, 0.8326741440377803, 0.8151848151848152, 0.3643699086805911, 0.38287887257508, 0.959007659007659, 0.9455657768157768, 0.7687303568539267, 0.633627028046991, 0.1063729462808914, 0.5977165108467629, 0.9500655624568669, 0.15446423832541123, 0.6012653282390124, 0.542308000641334, 0.7003125772911386, 0.08986914145046439, 0.8348615981480311, 0.31614695185180225, 0.7588008598553793, 0.7402549921261102, 0.19930301655551136, 0.9838235294117648, 0.7072021899394163, 0.5733647083778906, 0.34712454464020875, 0.8215195100452326, 0.7022517007906003, 0.8797773126344555, 0.3237221522067484, 0.4058893331801067, 0.9633810858507215, 0.666900871459695, 0.9945054945054945, 0.9697979797979798, 0.931031746031746, 0.5129226469429683, 0.765419983782987, 0.3315600316451265, 0.8754900192400191, 0.77513727013727, 0.7028810341579351, 0.14363206817757632, 0.5257061656970538, 0.9598765432098766, 0.08436618926676615, 0.43370201592898683, 0.41813684722335676, 0.6309790758224416, 0.7101968153882495, 0.8480913290356012, 0.4744275576653052, 0.41758658294025525, 0.9293854092767136, 0.5987207743523534, 0.8487747791153106, 0.8673384752962218, 0.9120716320716322, 0.744402212166918, 0.6886350843004069, 0.816327637504108, 0.5876618021354864, 0.5388055385452813, 0.23525007034614903, 0.7802250493109288, 0.9495448179271709, 0.8301170779812056, 0.4372976780817763, 0.447476171767946, 0.4975678953226132, 0.7200460459081148, 0.7729737764051489, 0.4476927276777726, 0.13053963342927993, 0.7584758052405111, 0.8723151117887961, 0.7619352066000337, 0.5063865816226438])
    }

    baseline_uncropped = {
        'rank1': np.array([1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0, 0, 0, 0, 1, 1, 0, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 0, 1, 1, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0, 1, 0]),
        'rank5': np.array([1, 1, 0, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0]),
        'ap': np.array([0.4572086838890615, 0.09993180020258957, 0.021005725458562493, 0.12677699174618492, 0.04006044075216541, 0.015699830619280465, 0.03656145136784719, 0.03879067581197648, 0.0847629322601469, 0.31654020637040525, 0.02951301841812795, 0.15375473955890712, 0.09535419445747875, 0.27021457958490486, 0.14179333702558264, 0.032524714329919935, 0.12169599089605235, 0.13527040177399774, 0.22548620126965976, 0.17087238004837416, 0.0170025363871212, 0.1960732843956614, 0.02314623016433871, 0.08402654360931736, 0.11778854226605108, 0.1543316940746238, 0.017472479490954002, 0.4135722337104471, 0.3010364835488886, 0.10759905640906929, 0.24180462257072796, 0.01660235077763641, 0.11564925710759243, 0.1490947801275707, 0.054733394931400746, 0.03470769197645878, 0.06745228606587482, 0.019486684342238554, 0.06139103403928787, 0.3378619364569663, 0.12905575609983172, 0.10673362494367905, 0.014865519445467306, 0.5206338787694083, 0.1384923535801278, 0.1595834200291425, 0.6719817507301286, 0.16573076925717148, 0.18558903644080382, 0.13832162799628064, 0.18780001303635438, 0.3591959152604086, 0.06213321940113948, 0.6830681865392875, 0.25834144405413073, 0.547306832426922, 0.2528898264106304, 0.5169858513889031, 0.24604945673766368, 0.4102863693270413, 0.20616638259635156, 0.3288880299943787, 0.07573692206622436, 0.03844105827714772, 0.2859441290742205, 0.1540151427679682, 0.40828291994353694, 0.01928029850286598, 0.10097601200587011, 0.17526253488856722, 0.05884470774732857, 0.1348075418508085, 0.18927386091733284, 0.03476006809354434, 0.05344873710204289, 0.05161826541045997, 0.28073244058432345, 0.13947900020943918, 0.04946636636856606, 0.3031791059970968, 0.10466524990790899, 0.23172827278014274, 0.2536321000310539, 0.04370553963629573, 0.1871546332398943, 0.15672812906049943, 0.6260757095350772, 0.08794025742808718, 0.09302699405179071, 0.24493480543824397, 0.10701572471647366, 0.10970370877903042, 0.4570898874762767, 0.052888504390101135, 0.2848880709519144, 0.058128282596637305, 0.46117579559255667, 0.08450982436515293, 0.3472320281523682, 0.04418748483143996])
    }

    hypothesis_2(hybrid_uncropped_clahe, baseline_uncropped, hybrid_cropped_clahe)


    hybrid_uncropped_no_clahe = {
        'rank1': np.array([1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 1, 0, 1, 0, 1, 0, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]),
        'rank5': np.array([1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]),
        'ap': np.array([0.905168426344897, 0.28812596065604973, 0.20781872733930873, 0.44808769542355875, 0.9474358974358974, 0.9821428571428571, 0.7614761356634422, 0.5481473062159335, 0.9815204678362572, 0.3571651688022744, 0.8091057751772036, 0.35254175706203017, 0.2986015021134271, 0.6701889270000725, 0.831661616161616, 0.889467263104481, 0.4897841580745562, 0.8621794871794871, 0.6715547037988941, 0.9623156448814344, 0.5747284878863826, 0.6691824487140822, 0.3406878445224538, 0.8482627221263584, 0.9935897435897436, 0.37876110867686386, 0.5602386952435848, 0.7249124909839194, 0.9935897435897436, 0.8702770377770379, 0.7298916327241451, 0.08312711288542636, 0.5487544235680587, 0.6517586155674392, 0.23088300519114238, 0.7992544803762172, 0.5711219336219336, 0.8468931068931068, 0.2048484362985199, 0.8705255392755394, 0.23119781578199428, 0.654837622254289, 0.6244346351323095, 0.3764588031794064, 0.9829505135387488, 0.6657264196977927, 0.8616035256371393, 0.22196771351615424, 0.8740127766012148, 0.7257163385784076, 0.8434725459725461, 0.3997050456792112, 0.4327974762604159, 0.9455374753451677, 0.9519959778783309, 0.9838264299802761, 1.0, 0.9601831123812549, 0.7431414149278522, 0.7647525676937442, 0.42262067525324576, 0.8665591625150447, 0.9723622782446313, 0.7798028659793366, 0.6849480685007002, 0.7773079339091976, 0.9888888888888889, 0.4021873857273713, 0.44845195474810584, 0.511584876523467, 0.9765079365079364, 0.6800631686241968, 0.755504621834545, 0.4857508541766414, 0.3141540162906444, 0.8867669711322962, 0.6734345673819359, 0.8009696784696784, 0.8042781120954496, 0.9069874569874571, 0.7009840734521587, 0.49168571624453977, 0.8622841363230379, 0.6674419102169941, 0.8596560846560846, 0.37518210620025133, 0.9796825396825397, 0.9619047619047619, 0.8070343387006265, 0.6891558490058869, 0.37593246261026375, 0.6587495068306494, 0.7584879621822324, 0.7848350223122197, 0.6574247442954537, 0.4595041095617132, 0.9958333333333333, 0.7670377572283199, 0.7276902438644294, 0.36061897977513097])
    }

    hybrid_cropped_no_clahe = {
        'rank1': np.array([1, 0, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 1, 0, 1, 0, 1, 0, 0, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 0, 1, 1, 1, 1]),
        'rank5': np.array([1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]),
        'ap': np.array([0.7081992563107113, 0.19896339991591425, 0.39754583052460946, 0.3867530124761632, 0.9332206255283177, 1.0, 0.751216512245924, 0.3992702119721487, 0.7597784622784624, 0.113749814209104, 0.8301384656426672, 0.3266825406070562, 0.19282701031825364, 0.7919768697993029, 0.8189839764445118, 0.8300884043144104, 0.4689940905579356, 0.8226892990050886, 0.27774383056358887, 0.8875799661513949, 0.38871635610766037, 0.6291574400848217, 0.18713635175932733, 0.8875553958557909, 0.9935897435897436, 0.27204226273781357, 0.30372678606501796, 0.7026656584259247, 1.0, 0.8737597876216802, 0.6899115424291272, 0.05833767550264745, 0.5672436012191652, 0.6202528054316513, 0.4597057630814436, 0.7417720893453743, 0.561339178159648, 0.6728112582905817, 0.12225671475603002, 0.6199062911554881, 0.198901060980932, 0.7142657042488529, 0.5367761596329635, 0.3197172238205519, 0.9778223084105437, 0.6155945709987712, 0.8073548482169173, 0.13991746251051912, 0.8582823016710485, 0.7896755543438169, 0.6494497829536192, 0.4279587510444539, 0.62016846828317, 0.7727435830555621, 0.9294803453626983, 0.9060411810411809, 0.9733333333333334, 0.9677414690572586, 0.6213072513072514, 0.7314878325800979, 0.2607606727295682, 0.8167162698412698, 0.9506280193236715, 0.9107537436108865, 0.5603813408813407, 0.9465706707086018, 0.8949445616112283, 0.21340808541545056, 0.48677139446838436, 0.5386296310942484, 0.911405230476438, 0.42891450542290205, 0.6754642135756688, 0.41514138197673406, 0.5253522054109324, 0.6548051828146726, 0.7356291511939779, 0.723257757648514, 0.5576026422579425, 0.5298481094069328, 0.6016111326116836, 0.5901308218609003, 0.758381764434396, 0.5525689095317292, 0.2996197227098994, 0.5619433511022954, 0.9157314761262131, 0.8864693438606481, 0.6989877186305756, 0.6571639898562975, 0.4029942938045705, 0.5635450123353348, 0.7260324235529819, 0.8221093285799167, 0.6601138367805034, 0.3991544032392261, 0.9392592592592592, 0.6682115294360407, 0.8070910181436498, 0.3036082268776609])
    }

    hypothesis_3(hybrid_uncropped_clahe, hybrid_uncropped_no_clahe, hybrid_cropped_clahe, hybrid_cropped_no_clahe)
